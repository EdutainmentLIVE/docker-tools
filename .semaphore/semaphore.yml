version: v1.0
name: Default pipeline
agent:
  machine:
    type: e1-standard-2
  containers:
    - name: main
      image: semaphoreci/haskell:8.10.2
blocks:
  - name: Default block
    task:
      jobs:
        - name: Default job
          commands:
            - checkout
            - cache restore hackage
            - cabal update
            - cache delete hackage
            - cache store hackage ~/.cabal
            - cabal freeze
            - cat cabal.project.freeze
            - cache restore cabal-$( checksum cabal.project.freeze ),cabal
            - cabal build
            - cache store cabal-$( checksum cabal.project.freeze ) ~/.cabal/store
