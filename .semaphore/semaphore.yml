version: v1.0
name: Default pipeline
agent:
  machine:
    type: e1-standard-2
    os_image: ubuntu1804
  containers:
    - name: main
      image: itprotv/stack:v2.5.1
      command: echo $SEMAPHORE_PIPELINE_ID
      
blocks:
  - name: Build block
    task:
      jobs:
        - name: Build job
          commands_file: build.sh
  - name: Docker block
    task:
      agent:
        machine:
          type: e1-standard-2
          os_image: ubuntu1804
      secrets:
        - name: docker-hub
      jobs:
        - name: Brittany job
          env_vars: [ { name: TOOL, value: brittany } ]
          commands_file: docker.sh
        - name: Hasktags job
          env_vars: [ { name: TOOL, value: hasktags } ]
          commands_file: docker.sh
        - name: Hlint job
          env_vars: [ { name: TOOL, value: hlint } ]
          commands_file: docker.sh
        - name: Stan job
          env_vars: [ { name: TOOL, value: stan } ]
          commands_file: docker.sh
        - name: Stylish Haskell job
          env_vars: [ { name: TOOL, value: stylish-haskell } ]
          commands_file: docker.sh
        - name: Weeder job
          env_vars: [ { name: TOOL, value: weeder } ]
          commands_file: docker.sh
